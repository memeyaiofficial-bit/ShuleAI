<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Accent Adventure Kenya - Master Different English Accents</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(
          135deg,
          #667eea 0%,
          #764ba2 50%,
          #f093fb 100%
        );
        min-height: 100vh;
        padding: 20px;
        position: relative;
        overflow-x: hidden;
      }

      .floating-accents {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
        opacity: 0.1;
      }

      .accent-bubble {
        position: absolute;
        font-size: 2rem;
        animation: float 6s ease-in-out infinite;
      }

      .accent-bubble:nth-child(1) {
        top: 10%;
        left: 15%;
        animation-delay: 0s;
      }
      .accent-bubble:nth-child(2) {
        top: 60%;
        right: 20%;
        animation-delay: 2s;
      }
      .accent-bubble:nth-child(3) {
        bottom: 20%;
        left: 25%;
        animation-delay: 4s;
      }
      .accent-bubble:nth-child(4) {
        top: 35%;
        right: 15%;
        animation-delay: 1s;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        25% {
          transform: translateY(-20px) rotate(90deg);
        }
        50% {
          transform: translateY(-10px) rotate(180deg);
        }
        75% {
          transform: translateY(-15px) rotate(270deg);
        }
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        position: relative;
      }

      .header {
        text-align: center;
        color: white;
        margin-bottom: 30px;
        animation: accentEntrance 2s ease-out;
      }

      .header h1 {
        font-size: 3.5rem;
        margin-bottom: 15px;
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.4);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
      }

      .header p {
        font-size: 1.3rem;
        opacity: 0.95;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
      }

      .stats-dashboard {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 20px;
        margin-bottom: 25px;
      }

      .stat-widget {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 25px;
        text-align: center;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .stat-widget::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(102, 126, 234, 0.1) 0%,
          transparent 50%
        );
        animation: shimmer 3s ease-in-out infinite;
      }

      @keyframes shimmer {
        0%,
        100% {
          transform: rotate(0deg);
        }
        50% {
          transform: rotate(180deg);
        }
      }

      .stat-widget:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
      }

      .stat-icon {
        font-size: 2.5rem;
        margin-bottom: 12px;
        position: relative;
        z-index: 1;
      }

      .stat-label {
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 8px;
        font-weight: 600;
      }

      .stat-value {
        font-size: 1.8rem;
        font-weight: bold;
        color: #667eea;
      }

      .game-container {
        background: rgba(255, 255, 255, 0.96);
        border-radius: 20px;
        padding: 35px;
        margin-bottom: 25px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        position: relative;
        border: 3px solid #667eea;
      }

      .game-container::before {
        content: "üé≠";
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 2rem;
        opacity: 0.7;
      }

      .accent-showcase {
        text-align: center;
        background: linear-gradient(135deg, #e3f2fd, #bbdefb);
        border-radius: 18px;
        padding: 40px;
        margin-bottom: 25px;
        border: 3px solid #2196f3;
        position: relative;
      }

      .current-phrase {
        font-size: 2.8rem;
        font-weight: bold;
        color: #0d47a1;
        margin-bottom: 18px;
        text-transform: capitalize;
        letter-spacing: 2px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .accent-display {
        font-size: 1.8rem;
        color: #1976d2;
        margin-bottom: 18px;
        font-family: "Courier New", monospace;
        background: rgba(255, 255, 255, 0.8);
        padding: 12px 25px;
        border-radius: 30px;
        display: inline-block;
        border: 2px solid #42a5f5;
      }

      .accent-context {
        background: #e8f5e8;
        border-radius: 15px;
        padding: 25px;
        margin: 25px 0;
        border: 3px solid #4caf50;
        position: relative;
      }

      .accent-context::before {
        content: "üåç";
        position: absolute;
        top: -15px;
        left: 25px;
        background: #e8f5e8;
        padding: 0 15px;
        font-size: 2rem;
      }

      .context-header {
        font-weight: bold;
        color: #2e7d32;
        margin-bottom: 15px;
        font-size: 1.3rem;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .context-description {
        color: #1b5e20;
        font-style: italic;
        line-height: 1.7;
        font-size: 1.15rem;
        text-align: center;
      }

      .pronunciation-tools {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 30px 0;
        flex-wrap: wrap;
      }

      .accent-btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 18px 35px;
        border-radius: 50px;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        display: inline-flex;
        align-items: center;
        gap: 12px;
        font-weight: 600;
      }

      .accent-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      }

      .accent-btn.recording {
        background: linear-gradient(135deg, #e91e63, #ad1457);
        animation: accentPulse 1.2s infinite;
      }

      @keyframes accentPulse {
        0% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(233, 30, 99, 0.7);
        }
        70% {
          transform: scale(1.05);
          box-shadow: 0 0 0 10px rgba(233, 30, 99, 0);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(233, 30, 99, 0);
        }
      }

      .demo-btn {
        background: linear-gradient(135deg, #4caf50, #2e7d32);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 25px;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
      }

      .demo-btn:hover {
        background: linear-gradient(135deg, #2e7d32, #4caf50);
        transform: translateY(-2px);
      }

      .feedback-zone {
        background: #f3e5f5;
        border-radius: 18px;
        padding: 30px;
        margin: 25px 0;
        border-left: 6px solid #9c27b0;
        display: none;
        text-align: center;
      }

      .feedback-zone.show {
        display: block;
        animation: accentReveal 0.6s ease-out;
      }

      @keyframes accentReveal {
        from {
          opacity: 0;
          transform: scale(0.8) translateY(-30px);
        }
        to {
          opacity: 1;
          transform: scale(1) translateY(0);
        }
      }

      .feedback-emoji {
        font-size: 4rem;
        margin-bottom: 20px;
        animation: bounce 0.8s ease-in-out;
      }

      .feedback-title {
        font-size: 1.5rem;
        font-weight: bold;
        color: #6a1b9a;
        margin-bottom: 12px;
      }

      .feedback-message {
        color: #4a148c;
        line-height: 1.6;
        font-size: 1.1rem;
      }

      .progress-tracker {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 25px;
        margin: 25px 0;
        text-align: center;
      }

      .progress-header {
        font-size: 1.3rem;
        color: #667eea;
        margin-bottom: 18px;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }

      .progress-container {
        background: #e0e0e0;
        height: 25px;
        border-radius: 15px;
        overflow: hidden;
        margin: 15px 0;
        position: relative;
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
        transition: width 0.6s ease;
        border-radius: 15px;
        position: relative;
      }

      .progress-bar::after {
        content: "üé≠";
        position: absolute;
        right: -15px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 1.5rem;
      }

      .level-indicator {
        display: inline-block;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 10px 25px;
        border-radius: 25px;
        font-weight: bold;
        margin-top: 15px;
        font-size: 1rem;
      }

      .continue-btn {
        background: linear-gradient(135deg, #ff9800, #f57c00);
        color: white;
        border: none;
        padding: 18px 40px;
        border-radius: 30px;
        font-size: 1.3rem;
        cursor: pointer;
        transition: all 0.3s ease;
        margin: 25px auto;
        display: block;
        font-weight: 600;
      }

      .continue-btn:hover {
        background: linear-gradient(135deg, #f57c00, #ff9800);
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(255, 152, 0, 0.3);
      }

      .accent-tips {
        background: #fff8e1;
        border-radius: 18px;
        padding: 25px;
        margin-top: 25px;
        border: 3px solid #ffc107;
      }

      .tips-header {
        font-size: 1.3rem;
        color: #f57f17;
        margin-bottom: 18px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .tip-card {
        background: rgba(255, 255, 255, 0.8);
        padding: 15px;
        margin: 12px 0;
        border-radius: 10px;
        border-left: 4px solid #ff9800;
        transition: all 0.3s ease;
      }

      .tip-card:hover {
        background: white;
        transform: translateX(5px);
      }

      .home-link {
        position: fixed;
        top: 25px;
        left: 25px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        padding: 15px 25px;
        border-radius: 30px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        font-weight: 600;
      }

      .home-link:hover {
        background: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      @keyframes accentEntrance {
        0% {
          transform: scale(0.5) translateY(-100px);
          opacity: 0;
        }
        50% {
          transform: scale(1.1) translateY(-20px);
          opacity: 0.8;
        }
        100% {
          transform: scale(1) translateY(0);
          opacity: 1;
        }
      }

      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-20px);
        }
        60% {
          transform: translateY(-10px);
        }
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 2.5rem;
        }
        .current-phrase {
          font-size: 2rem;
        }
        .stats-dashboard {
          grid-template-columns: repeat(2, 1fr);
        }
        .pronunciation-tools {
          flex-direction: column;
          align-items: center;
        }
        .accent-bubble {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <button class="home-link" onclick="returnHome()">üè† Home</button>

    <div class="floating-accents">
      <div class="accent-bubble">üá¨üáß</div>
      <div class="accent-bubble">üá∫üá∏</div>
      <div class="accent-bubble">üá¶üá∫</div>
      <div class="accent-bubble">üá∞üá™</div>
    </div>

    <div class="container">
      <div class="header">
        <h1>üé≠ Accent Adventure Kenya üåç</h1>
        <p>Master different English accents and pronunciation styles!</p>
      </div>

      <div class="stats-dashboard">
        <div class="stat-widget">
          <div class="stat-icon">üé≠</div>
          <div class="stat-label">Accent Level</div>
          <div class="stat-value" id="accentLevel">1</div>
        </div>
        <div class="stat-widget">
          <div class="stat-icon">üèÜ</div>
          <div class="stat-label">Accent Points</div>
          <div class="stat-value" id="accentPoints">0</div>
        </div>
        <div class="stat-widget">
          <div class="stat-icon">üåç</div>
          <div class="stat-label">Accents Mastered</div>
          <div class="stat-value" id="accentsMastered">0</div>
        </div>
        <div class="stat-widget">
          <div class="stat-icon">üéØ</div>
          <div class="stat-label">Accuracy Rate</div>
          <div class="stat-value" id="accuracyRate">0%</div>
        </div>
      </div>

      <div class="game-container">
        <div class="accent-showcase">
          <div class="current-phrase" id="currentPhrase">
            Hello, how are you today?
          </div>
          <div class="accent-display" id="accentType">British English (RP)</div>
          <div class="level-indicator" id="difficultyLevel">
            üá¨üáß Beginner Level
          </div>
        </div>

        <div class="accent-context">
          <div class="context-header">üåç Accent Background</div>
          <div class="context-description" id="accentContext">
            Received Pronunciation (RP) is the traditional "Queen's English"
            accent, commonly used in BBC broadcasts and formal settings in the
            UK.
          </div>
        </div>

        <div class="pronunciation-tools">
          <button
            class="accent-btn"
            id="recordButton"
            onclick="toggleAccentRecording()"
          >
            üé§ Start Recording
          </button>
          <button class="demo-btn" id="demoButton" onclick="playAccentDemo()">
            üîä Listen to Demo
          </button>
        </div>

        <div class="feedback-zone" id="accentResults">
          <div class="feedback-emoji" id="resultEmoji">üéâ</div>
          <div class="feedback-title" id="resultTitle">
            Brilliant Accent Work!
          </div>
          <div class="feedback-message" id="resultMessage">
            You've captured the accent perfectly!
          </div>
        </div>

        <div class="progress-tracker">
          <div class="progress-header">üé≠ Accent Mastery Progress</div>
          <div class="progress-container">
            <div
              class="progress-bar"
              id="accentProgress"
              style="width: 0%"
            ></div>
          </div>
          <div id="progressStatus">
            Accents Explored: 0/12 different accents mastered
          </div>
        </div>

        <button
          class="continue-btn"
          id="continueButton"
          onclick="nextAccentChallenge()"
          style="display: none"
        >
          Next Accent Challenge üåç
        </button>
      </div>

      <div class="accent-tips">
        <div class="tips-header">üéØ Accent Mastery Tips</div>
        <div class="tip-card">
          üá¨üáß <strong>British RP:</strong> Drop the 'R' sounds at the end of
          words and emphasize clear vowel sounds
        </div>
        <div class="tip-card">
          üá∫üá∏ <strong>American:</strong> Use strong 'R' sounds and flatten some
          vowel pronunciations
        </div>
        <div class="tip-card">
          üá¶üá∫ <strong>Australian:</strong> Raise the pitch at the end of
          statements and shorten vowel sounds
        </div>
        <div class="tip-card">
          üá∞üá™ <strong>Kenyan English:</strong> Clear articulation with slight
          syllable emphasis and rhythmic patterns
        </div>
        <div class="tip-card">
          üé≠ <strong>Practice Tip:</strong> Listen carefully to native speakers
          and mimic their rhythm and intonation
        </div>
      </div>
    </div>

    <script>
      class AccentAdventureKenya {
        constructor() {
          this.accentPhrases = [
            {
              phrase: "Hello, how are you today?",
              accent: "British English (RP)",
              context:
                "Received Pronunciation (RP) is the traditional 'Queen's English' accent, commonly used in BBC broadcasts and formal settings in the UK.",
              difficulty: "beginner",
              flag: "üá¨üáß",
            },
            {
              phrase: "I'm going to the store right now.",
              accent: "American English",
              context:
                "General American accent is the most widely spoken accent in the United States, characterized by strong R sounds and distinct vowel pronunciations.",
              difficulty: "beginner",
              flag: "üá∫üá∏",
            },
            {
              phrase: "G'day mate, what's happening today?",
              accent: "Australian English",
              context:
                "Australian English features a distinctive rising intonation and vowel sounds that differ significantly from British and American accents.",
              difficulty: "intermediate",
              flag: "üá¶üá∫",
            },
            {
              phrase: "Welcome to Kenya, karibu sana!",
              accent: "Kenyan English",
              context:
                "Kenyan English blends standard English with local linguistic influences, featuring clear articulation and rhythmic speech patterns.",
              difficulty: "beginner",
              flag: "üá∞üá™",
            },
            {
              phrase: "The weather is absolutely brilliant today!",
              accent: "British English (Cockney)",
              context:
                "Cockney is a traditional working-class London accent known for its distinctive pronunciation and occasional rhyming slang.",
              difficulty: "intermediate",
              flag: "üá¨üáß",
            },
            {
              phrase: "Y'all come back now, you hear?",
              accent: "Southern American",
              context:
                "Southern American English features elongated vowels, slower speech patterns, and distinctive regional vocabulary.",
              difficulty: "intermediate",
              flag: "üá∫üá∏",
            },
            {
              phrase: "That's a beauty of a sunset, eh?",
              accent: "Canadian English",
              context:
                "Canadian English combines British and American influences with unique Canadian pronunciations and the characteristic 'eh?'",
              difficulty: "intermediate",
              flag: "üá®üá¶",
            },
            {
              phrase: "Would you like a cup of tea then?",
              accent: "Irish English",
              context:
                "Irish English features musical intonation patterns and distinctive vowel sounds influenced by the Irish language.",
              difficulty: "intermediate",
              flag: "üáÆüá™",
            },
            {
              phrase: "Och, it's a bonnie day in the highlands!",
              accent: "Scottish English",
              context:
                "Scottish English features rolled R sounds, distinctive vowel pronunciations, and vocabulary influenced by Scots Gaelic.",
              difficulty: "advanced",
              flag: "üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø",
            },
            {
              phrase: "The rugby match was absolutely fantastic!",
              accent: "New Zealand English",
              context:
                "New Zealand English has unique vowel shifts and is known for the 'Kiwi accent' with distinctive pronunciation patterns.",
              difficulty: "advanced",
              flag: "üá≥üáø",
            },
            {
              phrase: "I'm just now going to the robot for petrol.",
              accent: "South African English",
              context:
                "South African English incorporates influences from Afrikaans and local languages, with unique vocabulary and pronunciation.",
              difficulty: "advanced",
              flag: "üáøüá¶",
            },
            {
              phrase:
                "The monsoon season brings abundant rain to our beautiful country.",
              accent: "Indian English",
              context:
                "Indian English features distinctive rhythm patterns and pronunciation influenced by various Indian languages.",
              difficulty: "advanced",
              flag: "üáÆüá≥",
            },
          ];

          this.currentIndex = 0;
          this.accentPoints = 0;
          this.accentLevel = 1;
          this.accentsMastered = 0;
          this.totalTries = 0;
          this.successfulTries = 0;
          this.isRecording = false;
          this.speechRecognition = null;

          this.initializeAccentAdventure();
        }

        initializeAccentAdventure() {
          this.updateAccentDisplay();
          this.setupSpeechTechnology();
          this.loadCurrentAccent();
        }

        setupSpeechTechnology() {
          if (
            "webkitSpeechRecognition" in window ||
            "SpeechRecognition" in window
          ) {
            const SpeechRecognition =
              window.SpeechRecognition || window.webkitSpeechRecognition;
            this.speechRecognition = new SpeechRecognition();
            this.speechRecognition.continuous = false;
            this.speechRecognition.interimResults = false;
            this.speechRecognition.lang = "en-US";

            this.speechRecognition.onresult = (event) => {
              const spokenPhrase = event.results[0][0].transcript.toLowerCase();
              this.evaluateAccentPronunciation(spokenPhrase);
            };

            this.speechRecognition.onerror = (event) => {
              console.error("Accent recognition error:", event.error);
              this.showAccentResults(
                "üé≠",
                "Accent Challenge!",
                "We couldn't quite catch that accent. Try again with clear pronunciation!",
              );
              this.stopAccentRecording();
            };

            this.speechRecognition.onend = () => {
              this.stopAccentRecording();
            };
          } else {
            console.warn("Speech recognition not supported on this device");
          }
        }

        loadCurrentAccent() {
          const accentData = this.accentPhrases[this.currentIndex];
          document.getElementById("currentPhrase").textContent =
            accentData.phrase;
          document.getElementById("accentType").textContent = accentData.accent;
          document.getElementById("accentContext").textContent =
            accentData.context;

          const difficultyLevels = {
            beginner: "üåü Beginner Level",
            intermediate: "‚≠ê Intermediate Level",
            advanced: "üèÜ Advanced Level",
          };
          document.getElementById("difficultyLevel").textContent =
            accentData.flag +
            " " +
            (difficultyLevels[accentData.difficulty] || "üåü Beginner Level");

          document.getElementById("continueButton").style.display = "none";
          document.getElementById("accentResults").classList.remove("show");
          document.getElementById("demoButton").disabled = false;
        }

        toggleAccentRecording() {
          if (this.isRecording) {
            this.stopAccentRecording();
          } else {
            this.startAccentRecording();
          }
        }

        startAccentRecording() {
          if (this.speechRecognition) {
            this.isRecording = true;
            const recordBtn = document.getElementById("recordButton");
            recordBtn.classList.add("recording");
            recordBtn.innerHTML = "‚èπÔ∏è Stop Recording";

            try {
              this.speechRecognition.start();
            } catch (error) {
              console.error("Error starting accent recording:", error);
              this.stopAccentRecording();
            }
          }
        }

        stopAccentRecording() {
          this.isRecording = false;
          const recordBtn = document.getElementById("recordButton");
          recordBtn.classList.remove("recording");
          recordBtn.innerHTML = "üé§ Start Recording";

          if (this.speechRecognition) {
            this.speechRecognition.stop();
          }
        }

        playAccentDemo() {
          const accentData = this.accentPhrases[this.currentIndex];
          if ("speechSynthesis" in window) {
            const utterance = new SpeechSynthesisUtterance(accentData.phrase);
            utterance.rate = 0.8;
            utterance.pitch = 1.0;
            utterance.volume = 1;

            // Try to use appropriate voice based on accent
            const voices = speechSynthesis.getVoices();
            let preferredVoice = null;

            if (accentData.accent.includes("British")) {
              preferredVoice = voices.find(
                (voice) =>
                  voice.lang.includes("en-GB") ||
                  voice.name.toLowerCase().includes("british"),
              );
            } else if (accentData.accent.includes("American")) {
              preferredVoice = voices.find(
                (voice) =>
                  voice.lang.includes("en-US") ||
                  voice.name.toLowerCase().includes("american"),
              );
            } else if (accentData.accent.includes("Australian")) {
              preferredVoice = voices.find(
                (voice) =>
                  voice.lang.includes("en-AU") ||
                  voice.name.toLowerCase().includes("australian"),
              );
            }

            if (preferredVoice) {
              utterance.voice = preferredVoice;
            }

            speechSynthesis.speak(utterance);
          }
        }

        evaluateAccentPronunciation(spokenPhrase) {
          const targetPhrase =
            this.accentPhrases[this.currentIndex].phrase.toLowerCase();
          const similarity = this.calculatePhraseSimilarity(
            spokenPhrase,
            targetPhrase,
          );

          this.totalTries++;

          if (
            similarity > 0.7 ||
            this.containsKeyWords(spokenPhrase, targetPhrase)
          ) {
            this.handleSuccessfulAccent();
          } else if (similarity > 0.4) {
            this.showAccentResults(
              "üé≠",
              "Good Attempt!",
              `You said: "${spokenPhrase}". Try to match the rhythm and intonation more closely.`,
            );
          } else {
            this.showAccentResults(
              "üåç",
              "Keep Practicing!",
              `You said: "${spokenPhrase}". Listen to the demo again and focus on the accent's unique features.`,
            );
          }
        }

        containsKeyWords(spoken, target) {
          const spokenWords = spoken.split(" ");
          const targetWords = target.split(" ");
          let matches = 0;

          targetWords.forEach((word) => {
            if (
              spokenWords.some(
                (spokenWord) =>
                  spokenWord.includes(word.substring(0, 3)) ||
                  word.includes(spokenWord.substring(0, 3)),
              )
            ) {
              matches++;
            }
          });

          return matches >= Math.ceil(targetWords.length * 0.6);
        }

        handleSuccessfulAccent() {
          this.successfulTries++;
          this.accentPoints += 20;
          this.accentsMastered++;

          const accentAchievements = [
            "üé≠ Brilliant accent work! You sound like a native speaker!",
            "üåç Fantastic pronunciation! You've mastered this accent!",
            "üéØ Perfect intonation! Your accent skills are impressive!",
            "‚≠ê Excellent rhythm! You've captured the accent perfectly!",
            "üèÜ Outstanding! You're becoming an accent master!",
            "üåü Superb pronunciation! Keep up the excellent work!",
          ];

          const randomAchievement =
            accentAchievements[
              Math.floor(Math.random() * accentAchievements.length)
            ];
          this.showAccentResults("üèÜ", "Accent Mastered!", randomAchievement);

          document.getElementById("continueButton").style.display = "block";

          // Level progression
          if (this.accentsMastered % 4 === 0) {
            this.accentLevel++;
            this.showAccentResults(
              "‚≠ê",
              "Accent Level Up!",
              `Welcome to Accent Level ${this.accentLevel}! New accents await your mastery!`,
            );
          }

          this.updateAccentDisplay();
        }

        calculatePhraseSimilarity(phrase1, phrase2) {
          const longer = phrase1.length > phrase2.length ? phrase1 : phrase2;
          const shorter = phrase1.length > phrase2.length ? phrase2 : phrase1;
          const editDistance = this.computeLevenshteinDistance(longer, shorter);
          return (longer.length - editDistance) / longer.length;
        }

        computeLevenshteinDistance(str1, str2) {
          const matrix = [];
          for (let i = 0; i <= str2.length; i++) {
            matrix[i] = [i];
          }
          for (let j = 0; j <= str1.length; j++) {
            matrix[0][j] = j;
          }
          for (let i = 1; i <= str2.length; i++) {
            for (let j = 1; j <= str1.length; j++) {
              if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
                matrix[i][j] = matrix[i - 1][j - 1];
              } else {
                matrix[i][j] = Math.min(
                  matrix[i - 1][j - 1] + 1,
                  matrix[i][j - 1] + 1,
                  matrix[i - 1][j] + 1,
                );
              }
            }
          }
          return matrix[str2.length][str1.length];
        }

        showAccentResults(emoji, title, message) {
          document.getElementById("resultEmoji").textContent = emoji;
          document.getElementById("resultTitle").textContent = title;
          document.getElementById("resultMessage").textContent = message;
          document.getElementById("accentResults").classList.add("show");
        }

        nextAccentChallenge() {
          this.currentIndex =
            (this.currentIndex + 1) % this.accentPhrases.length;
          this.loadCurrentAccent();
        }

        updateAccentDisplay() {
          document.getElementById("accentLevel").textContent = this.accentLevel;
          document.getElementById("accentPoints").textContent =
            this.accentPoints;
          document.getElementById("accentsMastered").textContent =
            this.accentsMastered;

          const accuracy =
            this.totalTries > 0
              ? Math.round((this.successfulTries / this.totalTries) * 100)
              : 0;
          document.getElementById("accuracyRate").textContent = accuracy + "%";

          const progress =
            (this.accentsMastered / this.accentPhrases.length) * 100;
          document.getElementById("accentProgress").style.width =
            progress + "%";
          document.getElementById("progressStatus").textContent =
            `Accents Explored: ${this.accentsMastered}/${this.accentPhrases.length} different accents mastered`;
        }
      }

      function returnHome() {
        if (
          confirm(
            "Are you sure you want to end your Accent Adventure? Your progress will be saved!",
          )
        ) {
          window.location.href = "../../index.html";
        }
      }

      // Global wrapper functions for HTML onclick events
      function toggleAccentRecording() {
        if (window.accentGame) {
          window.accentGame.toggleAccentRecording();
        }
      }

      function playAccentDemo() {
        if (window.accentGame) {
          window.accentGame.playAccentDemo();
        }
      }

      function nextAccentChallenge() {
        if (window.accentGame) {
          window.accentGame.nextAccentChallenge();
        }
      }

      // Initialize game when page loads
      document.addEventListener("DOMContentLoaded", () => {
        window.accentGame = new AccentAdventureKenya();
      });

      // Load voices when they're available
      if ("speechSynthesis" in window) {
        speechSynthesis.onvoiceschanged = () => {
          console.log(
            "Accent voices loaded:",
            speechSynthesis.getVoices().length,
          );
        };
      }
    </script>
  </body>
</html>
